<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>webSocket</title>
</head>
<body>
<script>
	if ('WebSocket' in window) {
		const ws = window.ws = new WebSocket('ws://localhost:9998/')
    ws.onopen = () => {
		  console.log('连接')
      ws.send('send msg')
      ws.send('pic')
    }

    ws.onmessage = (evt) => {
		  if (Object.getPrototypeOf(evt.data) === String.prototype) {
        console.log(evt.data)
      } else {
		    const fr = new FileReader()
        fr.onload = (e) => {
		      const img = new Image()
          img.src = e.target.result
          document.body.append(img)
        }
        fr.readAsDataURL(evt.data)
      }
    }

    ws.onclose = () => {
      console.log('断开连接')
    }
	}
</script>
</body>
</html>
